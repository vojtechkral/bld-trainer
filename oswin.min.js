// Oswin 0.1 (b8e73413ca1035c1bb5421250ca3770706da70d9)
(function(t,v){"function"===typeof define&&define.amd?define(["jquery"],v):t.oswin=v(jQuery)})(this,function(t){if(!function(){if(Object.defineProperty)try{return Object.defineProperty({},"prop",{}),!0}catch(g){return!1}else return!1}())return console.error("Oswin: defineProperty required. (IE <= 8 is not supported.)"),!1;t={};var v={};(function(g,b,d,h){function k(a,e){for(var c=this.priv.events!==h?this.priv.events:this.priv.events={},f=a.split(/\s+/),l=0,g=f.length;l<g;l++){var n=f[l];n in c||
(c[n]=[]);-1===b.indexOf(c[n],e)&&c[n].push(e)}return this}function q(a,e){var c=function(){this.off(a,c);e.apply(this,Array.prototype.slice.call(arguments))};this.on(a,c);return this}function m(a,e){var c=this.priv.events;if(c===h)return this;for(var f=a.split(/\s+/),l=0,g=f.length;l<g;l++){var n=f[l];if(n in c){var d=e?b.indexOf(c[n],e):0;-1!==d&&c[n].splice(d,1)}}return this}function l(a){var e=this.priv.events;if(e===h||!1===a in e)return this;for(var c=Array.prototype.slice.call(arguments,1),
f=e[a].length-1;0<=f;f--)e[a][f].apply(this,c);return this}function n(a,e,c,f,l){var d;if(1==c)d=Object.keys(a);else if(2==c)d=Object.keys(e);else if(3==c){d=[];for(var k in a)k in e&&d.push(k)}else if(a!==h&&e!==h){d=Object.keys(a);var q=Object.keys(e);for(k=q.length-1;0<=k;k--)q[k]in a||d.push(q[k])}else d=a!==h?Object.keys(a):Object.keys(e);q=d.length;for(k=0;k<q;k++){var r=d[k],u=3==c||a!==h&&r in a,x=3==c||e!==h&&r in e,y=u&&g.isNonArrayObject(a[r]),m=x&&g.isNonArrayObject(e[r]),u=f(r,{"in":u,
isObj:y,obj:a},{"in":x,isObj:m,obj:e},l);u instanceof b.simWalkStop||(y&&2!=c||m&&1!=c)&&n(y?a[r]:h,m?e[r]:h,c,f,u)}}b.inherit=function(a,e){a.prototype=Object.create(e.prototype);a.prototype.constructor=a};b.defProp=function(a,e,c,f,l,b){Object.defineProperty(a,e,{configurable:c,enumerable:f,get:l,set:b})};b.defPrivate=function(a,e){b.defProp(a,"priv",!1,!1,function(){return e})};b.uniqueID=function(a){return(a?a:"")+Math.floor(1E5*Math.random()).toString(36)+Date.now().toString(36)};b.indexOf=function(a,
e){if(Array.prototype.indexOf&&a.indexOf===Array.prototype.indexOf)return a.indexOf(e);for(var c=0,f=a.length;c<f;c++)if(a[c]===e)return c;return-1};b.asEvented=function(a){a.on=k;a.off=m;a.trigger=l;a.once=q};g.argsSubstitute=function(a,e){for(var c=a,f=0,l=e.length;f<l;f++)c=c.replace(":"+f,e[f]);return c};g.isArrayLike=function(a){return"object"===typeof a&&"length"in a&&"number"===typeof a.length&&"splice"in a&&"function"===typeof a.splice};g.isNonArrayObject=function(a){return"object"===typeof a&&
!g.isArrayLike(a)};g.dotResolve=function(a,e){for(var c=e.split("."),f=!0,l=0;l<c.length-1;l++)if("object"===typeof a[c[l]]||"function"===typeof a[c[l]])a=a[c[l]];else{f=!1;break}return{parent:a,result:f?a[c[c.length-1]]:h}};g.haveLocalStorage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}};b.simWalkStop=function(){};g.simWalk=function(a,e,c,l,b){if(g.isNonArrayObject(a)&&g.isNonArrayObject(e))n(a,e,c,l,b);else throw"Oswin: simWalk(): Invalid arguments: obj1 or obj2 is not an object";
};g.simWalk.stop=function(){return new b.simWalkStop}})(t,v,jQuery);(function(g,b,d,h){b.Snippet=function(){this.p1=this.p2=!1;this.args=[]};b.Parser=function(b,d,l){this.name=b;this.p1re=d;this.p2re=l;this.current=this.attr_orig=this.attr=!1;this.result=[]};b.Parser.prototype.error=function(){throw"Oswin: Invalid "+this.name+" syntax: '"+this.attr_orig+"'";};b.Parser.prototype.parse_p1=function(){var b=this.p1re.exec(this.attr);null===b&&this.error();this.attr=this.attr.slice(b[0].length);this.current.p1=
b[1]};b.Parser.prototype.parse_p2=function(){if("/"!=this.attr[0])return!1;this.attr=this.attr.slice(1);match=this.p2re.exec(this.attr);null===match&&this.error();this.attr=this.attr.slice(match[0].length);this.current.p2=match[1];return!0};b.Parser.prototype.parse_args=function(){if("("==this.attr[0]){var b,d=!1;for(b=1;b<this.attr.length&&(d||")"!=this.attr[b]);b++)'"'==this.attr[b]&&(d=d?"\\"==this.attr[b]:!0);b>=this.attr.length&&this.error();d="["+this.attr.slice(1,b)+"]";this.attr=this.attr.slice(b+
1);try{d=JSON.parse(d)}catch(l){this.error()}this.current.args=d}};b.Parser.prototype.check_next=function(){if(0==this.attr.length)return!1;if(","==this.attr[0])return this.attr=this.attr.replace(/^,\s*/,""),!0;this.error()};b.Parser.prototype.parse_one=function(){this.current=new b.Snippet;this.parse_p1();this.parse_p2()&&this.parse_args();this.result.push(this.current)};b.Parser.prototype.parse=function(b){this.attr_orig=this.attr=b;this.current=!1;for(this.result=[];this.parse_one(),this.check_next(););
return this.result};var k=/^([_$a-zA-Z\xA0-\uFFFF][._$a-zA-Z0-9\xA0-\uFFFF]*)/;b.OCParser=function(){b.Parser.call(this,"data-oc",/^([^\s\/\"\'\(\),]+)/,k)};b.OCParser.prototype=b.Parser.prototype;b.ocParser=new b.OCParser;b.OVParser=function(){b.Parser.call(this,"data-ov",/^([._$a-zA-Z\xA0-\uFFFF][._$a-zA-Z0-9\xA0-\uFFFF]*)/,k)};b.OVParser.prototype=b.Parser.prototype;b.ovParser=new b.OVParser})(t,v,jQuery);(function(g,b,d,h){function k(e,c,a){this.ev=e!==h?e:!1;this.cb=c!==h?c:!1;this.args=a!==
h?a:[]}function q(a,c){var b=a.attr("id");if(b===h){var l=a.prop("tagName");l&&(b=l.toLowerCase())}return b===h?h:b+c.split(/\W/).map(function(c){return c.charAt(0).toUpperCase()+c.slice(1)}).join("")}function m(a,c){var b=d.Event(c);b.currentTarget=b.target=a[0];return b}function l(a,c){c.cb||(c.cb=q(a,c.ev));if(!c.cb)throw"Oswin: Callback neither specified nor could it be inferred";if(c.ev===b.evts.init)c.call(m(a,b.evts.init));else a.on(c.ev+b.evts_ns,function(a){var e=[].slice.call(arguments,
1);return c.call(a,e)})}function n(a,c){for(var b=0;b<c.length;b++){var d=c[b];l(a,new k(d.p1,d.p2,d.args))}}k.prototype.setCbFunc=function(a,c){this.cbfunc=a;this.cbthis=c};k.prototype.resolve=function(){!1!==g.config.resolver(this)||g.config.noBuiltins||b.builtins_resolver(this)};k.prototype.call=function(a,c){this.cbfunc===h&&this.resolve();if(this.cbfunc===h)throw"Oswin: Could not find callbak: "+this.cb;d.isArray(c)?c=c.concat(this.args):c=this.args;g.event=a;g.event.inst=d.data(a.currentTarget,
"oswin:inst");b.defProp(g.event,"$target",!0,!0,function(){return d(this.currentTarget)});return this.cbfunc.apply(this.cbthis,c)};var a={};b.builtins=a;b.default_resolver=function(a){var c=g.config.namespace;if("function"!==typeof c&&"object"!==typeof c)throw"Oswin: Invalid namespace";c=g.dotResolve(c,a.cb);if("function"!==typeof c.result)return!1;a.setCbFunc(c.result,c.parent);return a};b.builtins_resolver=function(b){return b.cb in a?(b.setCbFunc(a[b.cb],g),b):!1};a.$=function(a){var c=[].slice.call(arguments,
1);"function"===typeof d.fn[a]?d.fn[a].apply(g.event.$target,c):console.error("Oswin: No such function in jQuery: "+a)};a.css=function(){d.fn.css.apply(g.event.$target,arguments)};a.log=function(){if("console"in window&&"log"in window.console&&!(1>arguments.length))if("apply"in window.console.log&&"function"==typeof window.console.log.apply)window.console.log.apply(window.console,arguments);else{for(var a="window.console.log(arguments[0]",c=1;c<arguments.length;c++)a+=",arguments["+c+"]";logfn=new Function("arguments",
a+")");logfn(arguments)}};a.alert=function(a){alert(a)};a.focus=function(a){a!==h?"string"===typeof a?d(a).focus():a.focus():g.event.$target.focus()};a.html=function(a,c){var b=!g.config.noAuto;if(!0===c){var l=d.parseHTML(a);g.event.$target.append(l);b&&d(l).oswinBind()}else b&&g.event.$target.html(a).children().oswinBind()};a.trigger=function(a,c){if("string"!==typeof a&&"string"!==typeof c)throw"Oswin: trigger(): Invalid arguments";var b=[].slice.call(arguments,3);d(c).trigger(a,b)};d.fn.oswinCall=
function(a,c){if("string"===typeof a){var b=m(this,"oswin"),l=new k(b.type,a,[].slice.call(arguments,1));l.call(b)}else a instanceof d.Event&&"string"===typeof c&&(l=new k(a.type,c,[].slice.call(arguments,2)),l.call(a));return this};d.fn.oswinBind=function(a){if(a===h){for(var c=0;c<g.config.binds.length;c++){var f=g.config.binds[c][0],p=g.config.binds[c].slice(1);if("string"===typeof f)for(var f=this.find(f).add(this.filter(f)),m=f.length-1;0<=m;m--){var q=d(f[m]);q.oswinBind.apply(q,p)}}f=this.find("[data-oc]").addBack("[data-oc]");
for(c=f.length-1;0<=c;c--)p=d(f[c]),m=b.ocParser.parse(p.attr("data-oc")),n(p,m)}else c=[].slice.call(arguments,1),0<c.length?(f=c.shift(),c=new k(a,f,c),l(this,c)):(c=b.ocParser.parse(a),n(this,c));return this};d.fn.oswinUnbind=function(a){return this.off(a+b.evts_ns)}})(t,v,jQuery);(function(g,b,d,h){function k(b,d,a){this.$node=b;this.access=d;this.accessFunc=!1;this.args=a}function q(l,g,a){d.data(l[0],"oswin:inst",g);l=l.children();for(var e=0,c=l.length;e<c;e++){$i=d(l[e]);var f=$i.attr("data-ov");
if(f){for(var f=b.ovParser.parse(f),h,m=!0,w=0,t=f.length;w<t;w++){var r="."==f[w].p1[0]?a+f[w].p1:f[w].p1;"."==r[0]&&(r=r.substr(1));0==w&&(h=r);"view"==f[w].p2?m=!1:(new k($i,f[w].p2,f[w].args)).addTo(g,r)||(m=!1)}m&&q($i,g,h)}else q($i,g,a)}}Access={display:function(b,d,a,e){if(e===h)return"none"!=this.css("display");e.valueOf()?this.show():this.hide()},hide:function(b,d,a,e){return!Access.display.call(this,b,d,a,!e.valueOf())},"void":function(b,d,a,e){if(e===h)return null},html:function(b,d,a,
e){if(e===h)return this.html();this.html(e);g.config.noAuto||this.oswinBind()},href:function(b,d,a,e){if(e===h)return this.attr("href");if(0==a.length)this.attr("href",e);else{d=a[0];for(var c=[],f=1,k=a.length;f<k;f++)c.push(b.prop(a[f]));c.push(e);this.attr("href",g.argsSubstitute(d,c))}}};k.prototype.clone=function(b){b=new k(b,this.access,this.args);b.accessFunc=this.accessFunc;this.templates&&(b.templates=this.templates);return b};var m={input:!0,select:!0,textarea:!0,keygen:!0,output:!0};k.prototype.inferAccess=
function(b){!0===b.preferVoid?this.access="void":(b=(b=this.$node.prop("tagName"))?b.toLowerCase():h,this.access=m[b]?"val":"text")};k.prototype.resolveAccess=function(b){this.access||this.inferAccess(b);if(Access[this.access]!==h)this.accessFunc=Access[this.access];else if(d.fn[this.access]!==h)this.accessFunc="jQuery";else throw"Oswin: View: No such access function: "+this.access;};k.prototype.addTo=function(b,d){if(d in b.priv.prop){var a=b.priv.prop[d];this.resolveAccess(a);return a.addViewEle(this)}console.warn("Oswin: View: No such path in model: "+
d)};k.prototype.getset=function(b,g,a){return"jQuery"===this.accessFunc?a===h?d.fn[this.access].apply(this.$node,this.args):d.fn[this.access].apply(this.$node,this.args.concat([a])):this.accessFunc.call(this.$node,b,g,this.args,a)};k.prototype.assignID=function(){var d=this.$node.attr("data-ov-id");d===h&&(d=b.uniqueID(),this.$node.attr("data-ov-id",d));this.id=d;delete this.$node};b.view=function(b,g){var a;if("string"===typeof b){a=d('[data-ov="'+b+'/view"]');if(1>a.length)throw"Oswin: No such view: "+
b;if(1<a.length)throw"Oswin: Ambigous view name: "+b;}else a=b;q(a,g,"");return a};b.ViewTemplate=function(b,d){this.prop=b.priv.prop;b.view(d);for(var a in this.prop){var e=this.prop[a];if(e.viewEles)for(var c=e.viewEles.length-1;0<=c;c--)e.viewEles[c].assignID();else delete this.prop[a]}this.html=d.prop("outerHTML");if(this.html===h)throw"Oswin: View: Could not get element's html source via outerHTML";d.detach()};b.ViewTemplate.prototype.makeNode=function(){return d(d.parseHTML(this.html))};b.ViewTemplate.prototype.makeViewOn=
function(b,g){for(var a in this.prop)for(var e=this.prop[a],c=e.viewEles.length-1;0<=c;c--){var f=e.viewEles[c],h=g.find("[data-ov-id="+f.id+"]"),f=f.clone(h);b.priv.prop[a].addViewEle(f,!0);b.priv.prop[a].view()}a=g.find("*").addBack();for(c=a.length-1;0<=c;c--)d.data(a[c],"oswin:inst",b)};g.setAccessFunc=function(b,d,a){if("string"!==typeof b||"function"!==typeof d)throw"Oswin: view.setAccessFunc(): invalid argument";Access[b]=d;!0===a&&(Access[b].watch=!0)}})(t,v,jQuery);(function(g,b,d,h){function k(r,
a,b,c){this.value=r;this.name=a;this.inst=b;c!==h&&(this.parent=c)}function q(){}function m(r,a,b){k.call(this,new q,r,a,b)}function l(r,a,b,c){k.call(this,r.make(),a,b,c);this.value.parent=b;b.priv.mergeNestedProps(this.name,this.value)}function n(a){this.models=a;this.insts=[]}function a(a,c){var d=new n(a);b.defPrivate(this,d);d.prop=c;var e=this;b.defProp(this,"length",!1,!0,function(){return e.priv.insts.length})}function e(a){this.models=a}function c(a,b,c,d){k.call(this,a.make(this),b,c,d)}
function f(){this.prop={}}function p(a){var c=new f;b.defPrivate(this,c);var e=a.priv.config;d.extend(this,e.members);c.factory=a;c.defineData(this,e);for(var g in e.on)this.on(g,e.on[g]);this.ctor&&this.ctor()}function t(){}var w={url:{},data:{},members:{},on:{}},v={POST:!0,GET:!0,PUT:!0,DELETE:!0};b.Property=k;k.prototype.preferVoid=!1;k.prototype.get=function(){return this.value};k.prototype.set=function(a,b){this.value=a;this.triggerMod();this.view(b)};k.prototype.triggerMod=function(a){if(a===
h){a=this.name;var b=this.get();this.inst.trigger("mod",b,a);this.inst.trigger("mod:"+this.name,b,a)}else this.inst.trigger("mod:"+this.name,this.get(),a);this.parent!==h&&this.parent.triggerMod(a)};k.prototype.addViewEle=function(a){var c=this;if("void"!==a.access){this.viewEles===h?this.viewEles=[a]:this.viewEles.push(a);var d=this.viewEles.length-1;if("val"==a.access||a.accessFunc&&a.accessFunc.watch)a.$node.on("change"+b.evts_ns+" keyup"+b.evts_ns,function(){var b=a.getset(c.inst,c.name);c.get()!=
b&&c.set(b,d)});return!0}};k.prototype.view=function(a){if(this.viewEles!==h){var b="viewValue"in this?this.viewValue:this.value,c=this.viewEles.length-1;for(;0<=c;c--)c!==a&&this.viewEles[c].getset(this.inst,this.name,b)}};q.prototype.toJSON=function(){var a={},b;for(b in this)if(this.hasOwnProperty(b)&&"function"!==typeof this[b]){var c=this[b];a[b]="object"===typeof c&&"function"===typeof c.toJSON?c.toJSON():c}return a};b.inherit(m,k);b.NestedProperty=m;m.prototype.preferVoid=!0;m.prototype.get=
function(){return"alt"in this?this.alt:this.value};m.prototype.set=function(a){if("object"!==typeof a)this.alt=a,this.triggerMod(),this.view();else{"alt"in this&&(this.alt=a,this.triggerMod(),this.view(),delete this.alt);for(var b in this.value)b in a&&(this.value[b]=a[b])}};m.prototype.view=function(a){if(this.viewEles!==h&&"alt"in this)for(var b=this.viewEles.length-1;0<=b;b--)b!==a&&this.viewEles[b].getset(this.inst,this.name,this.alt)};b.inherit(l,k);b.NestedModelProperty=l;l.prototype.preferVoid=
!0;l.prototype.get=function(){return this.value.data};l.prototype.set=function(a,b){a instanceof p&&a.priv.factory==this.value.priv.factory?(this.value=a,this.value.parent=this.inst,this.inst.priv.mergeNestedProps(this.name,this.value)):this.value.data=a};l.prototype.addViewEle=function(a){this.value.view(a.$node);return!1};n.prototype.syncProps=function(a,c){var d;for(d=this.insts.length;d<c;d++)delete a[d];for(d=c;d<this.insts.length;d++)(function(c){b.defProp(a,c,!0,!0,function(){return a.priv.insts[c].data},
function(b){a.priv.insts[c].data=b})})(d);this.prop.triggerMod()};n.prototype.templateForModel=function(a){for(var b=this.models.length-1;0<=b;b--)if(this.models[b]==a)return this.colViewEle.templates[b];throw"Oswin: Internal error";};n.prototype.toInstances=function(a,b){for(var c=[].slice.call(b,0,a),d=a,e=b.length;d<e;d++)c[d]=b[d]instanceof p?b[d]:this.models[0].make(b[d]),c[d].parent=this.prop.inst;return c};n.prototype.syncView=function(a,b,c){for(var e=this.prop.viewEles.length-1;0<=e;e--){var g=
this.prop.viewEles[e];if("void"==g.access){for(var f=g.$node.children(),h=0;h<b;h++)d(f[a+h]).detach();for(var f=g.$node.children(),l,h=0;h<c;h++){var k=a+h,m=this.templateForModel(this.insts[k].priv.factory);$j=m.makeNode();0==h?0==k?g.$node.prepend($j):d(f[k-1]).after($j):l.after($j);$j.oswinBind();l=$j;m.makeViewOn(this.insts[k],$j)}}}this.prop.view()};a.prototype.splice=function(a){var b=this.length,c=[].splice.apply(this.priv.insts,this.priv.toInstances(2,arguments));this.priv.syncProps(this,
b);this.priv.colViewEle&&(a>b&&(a=b),0>a&&(a=b+a),0>a&&(a=0),b=arguments.length-2,0>b&&(b=0),this.priv.syncView(a,c.length,b));return c};a.prototype.push=function(){this.splice.apply(this,d.merge([this.length,0],arguments));return this.length};a.prototype.model=function(a){return this.priv.models[a]};a.prototype.instance=function(a){return this.priv.insts[a]};a.prototype.setData=function(a){if(!g.isArrayLike(a))throw"Oswin: Collection: setData: expected an array-like object";var b=this.length;this.priv.insts=
this.priv.toInstances(0,a);this.priv.syncProps(this,b);this.priv.colViewEle&&this.priv.syncView(0,b,this.length)};a.prototype.valueOf=function(){return this.length};a.prototype.toJSON=function(){return this.priv.insts.map(function(a){return a.toJSON()})};e.prototype.make=function(b){return new a(this.models,b)};g.collection=function(){for(var a=arguments.length-1;0<=a;a--)if(!(arguments[a]instanceof Model))throw"Oswin: Collection: Invalid argument "+a+": Not a Model";return new e([].slice.call(arguments))};
b.inherit(c,k);b.CollectionProperty=c;c.prototype.preferVoid=!0;c.prototype.set=function(a,b){this.value.setData(a)};c.prototype.addViewEle=function(a,c){this.viewEles===h?this.viewEles=[a]:this.viewEles.push(a);if("void"==a.access){if(!c){a.templates=[];var e=a.$node.children();if(e.length!=this.value.priv.models.length)throw"Oswin: Collection: Number of view elements and models in collection definition must be the same: "+this.name;var g=e.length;a.templates.length=g;for(var f=0;f<g;f++){var l=
d(e[f]),k=this.value.priv.models[f].make();k.parent=this.inst;a.templates[f]=new b.ViewTemplate(k,l)}}this.value.priv.colViewEle=a;this.value.priv.syncView(0,0,this.value.length);return!1}this.view();return!0};f.prototype.url=function(a,b){var c=this.factory.priv.config.url,c="update"!=a||c[a]?"delete"!=a||c[a]?c[a]:c.read:c.read;if(c===h)throw"Oswin: Model: No URL specified";return g.argsSubstitute(c,b)};f.prototype.defineData=function(a,d){var f=this;this.data=new m("",a);b.defProp(a,"data",!1,
!0,function(){return f.data.get()},function(a){f.data.set(a)});g.simWalk(d.data,{},1,function(d,f,h,u){h=f.obj[d];var x=u.name?u.name+"."+d:d,n,p=u;h instanceof Model?(n=new l(h,x,a,u),p=g.simWalk.stop()):h instanceof e?(n=new c(h,x,a,u),p=g.simWalk.stop()):f.isObj?p=n=new m(x,a,u):n=new k(h,x,a,u);a.priv.prop[x]=n;b.defProp(u.get(),d,!1,!0,function(){return n.get()},function(a){n.set(a)});return p},this.data)};f.prototype.mergeNestedProps=function(a,b){var c=b.priv.prop;a+=".";for(var d in c)this.prop[a+
d]&&this.prop[a+d].viewEles&&(c[d].viewEles=this.prop[a+d].viewEles,c[d].view()),this.prop[a+d]=c[d]};p.prototype.sync=!1;p.prototype.ctor=function(a){a&&(this.data=a)};p.prototype.create=function(){var a=this.priv.url("create",arguments);return this.priv.factory.sync(this,a,"POST")};p.prototype.get=function(){var a=this.priv.url("read",arguments);return this.priv.factory.sync(this,a,"GET")};p.prototype.update=function(){var a=this.priv.url("update",arguments);return this.priv.factory.sync(this,a,
"PUT")};p.prototype["delete"]=function(){var a=this.priv.url("delete",arguments);return this.priv.factory.sync(this,a,"DELETE")};p.prototype.prop=function(a,b){if("."==a[0]&&"."==a[1]){if(this.parent===h)throw"Oswin: No parent model instance set. Property requested: "+a;return this.parent.prop(a.slice(2),b)}if(!(a in this.priv.prop))throw"Oswin: Model: No such property: "+a;if(b===h)return this.priv.prop[a].get();this.priv.prop[a].set(b)};p.prototype.view=function(a){this.priv.$view=b.view(a,this);
for(var c in this.priv.prop)this.priv.prop[c].view()};p.prototype.$=function(a){if(a===h)return this.priv.$view;var b=d([]);ves=this.priv.prop[a].viewEles;if(ves===h)return b;a=0;for(var c=ves.length;a<c;a++)b.push(ves[a].$node[0]);return b};p.prototype.toJSON=function(){return this.data.toJSON()};b.asEvented(p.prototype);t.prototype.filterData=function(a,b){if(b===h)return a;if("function"===typeof b)return b(a);throw"Oswin: Model: filter not a function: "+b;};t.prototype.sync=function(a,b,c){if(!(c in
v))throw"Oswin: sync: undefined operation: "+c;if(a.sync)return console.warn("Model Instance is already performing a sync operation, aborting..."),!1;var e="POST"===c||"PUT"===c?JSON.stringify(this.filterData(a.toJSON(),this.config.upFilter)):h,f=this;b=d.ajax({complete:function(b,c){a.sync=!1;a.trigger("status",c,b)},contentType:"application/json",data:e,dataType:"json",success:function(b,c,d){"object"===typeof b&&(a.data=f.filterData(b,f.config.downFilter))},type:c,url:b});a.sync=!0;a.trigger("status",
"start",b);return b};Model=function(a){var c=new t;b.defPrivate(this,c);c.config=d.extend(!0,{},w,a)};Model.prototype.make=function(){var a=new p(this);a.ctor.apply(a,arguments);return a};Model.prototype.sync=function(a,b,c){return this.priv.sync(a,b,c)};g.localSync=function(a,b,c){if(!(c in v))throw"Oswin: sync: undefined operation: "+c;if(!g.haveLocalStorage())return console.error("Oswin: localSync(): HTML5 Local Storage not available"),!1;if("POST"===c||"PUT"===c)try{localStorage[b]=JSON.stringify(this.priv.filterData(a.toJSON(),
this.priv.config.upFilter))}catch(d){return console.error("Oswin: Exception in localSync(), probably because Local Storage quota was exceeded"),!1}else if("GET"===c){if(!(b in localStorage))return!0;try{a.data=JSON.parse(localStorage[b])}catch(e){return console.error("Oswin: localSync(): Malformed data"),!1}}else"DELETE"===c&&b in localStorage&&delete localStorage[b];return!0};g.model=function(a){return new Model(a)}})(t,v,jQuery);(function(g,b,d,h){b.evts={init:"init",ajax:"oswin:ajax"};b.evts_ns=
".oswin";b.navigating=!1;g.config=d.extend({},{namespace:window,noAuto:!1,noBuiltins:!1,binds:[],resolver:b.default_resolver});d(function(){d(window).on("beforeunload",function(){b.navigating=!0});d(document).oswinBind()})})(t,v,jQuery);return t});
